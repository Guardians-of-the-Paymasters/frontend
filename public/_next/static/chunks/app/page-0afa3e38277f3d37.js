(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5787:function(e,t,l){Promise.resolve().then(l.bind(l,5562))},5562:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return S}});var s=l(7437),a=l(2265),n=()=>{let[e,t]=(0,a.useState)(!1),[l,s]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{t(!0)},[]),{isMounted:e,isHovered:l,hoverHandlers:{onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1)}}};let x=e=>{let{className:t=""}=e,{isMounted:l}=n();return l?(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 18 9",fill:"none",className:t,children:(0,s.jsx)("path",{stroke:"#FFFFFF",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:10,strokeWidth:1.6,d:"m16.68.87-6.52 6.52c-.77.77-2.03.77-2.8 0L.84.87"})}):null},r=e=>({display1:"text-4xl md:text-5xl lg:text-6xl xl:text-7xl 2xl:text-8xl font-black",h1:"text-3xl md:text-4xl lg:text-5xl xl:text-6xl 2xl:text-7xl font-bold",h2:"text-xl md:text-2xl lg:text-3xl xl:text-4xl 2xl:text-5xl font-bold",h3:"text-lg md:text-xl lg:text-2xl xl:text-3xl 2xl:text-4xl font-bold",h4:"text-base md:text-lg lg:text-xl xl:text-2xl 2xl:text-3xl font-bold",h5:"text-sm md:text-sm lg:text-base xl:text-base 2xl:text-lg font-bold",h6:"text-xs md:text-xs lg:text-sm xl:text-sm 2xl:text-base font-bold",button1:"text-lg md:text-xl lg:text-2xl xl:text-3xl 2xl:text-4xl font-bold",button2:"text-base md:text-lg lg:text-xl xl:text-2xl 2xl:text-lg font-bold",button3:"text-sm md:text-sm lg:text-sm xl:text-base 2xl:text-lg font-bold",body1:"text-base md:text-lg lg:text-xl xl:text-2xl 2xl:text-3xl font-light",body2:"text-sm md:text-base lg:text-lg xl:text-xl 2xl:text-2xl font-light",body3:"text-xs md:text-sm lg:text-base xl:text-lg 2xl:text-xl font-light",body4:"text-xs md:text-xs lg:text-sm xl:text-base 2xl:text-lg font-light",body5:"text-xs md:text-xs lg:text-xs xl:text-sm 2xl:text-base font-light",body6:"text-xs md:text-xs lg:text-xs xl:text-sm 2xl:text-sm font-light",subtitle1:"text-base md:text-lg lg:text-xl xl:text-2xl 2xl:text-3xl font-normal",subtitle2:"text-xs md:text-sm lg:text-base xl:text-lg 2xl:text-xl font-normal",subtitle3:"text-xs md:text-xs lg:text-sm xl:text-base 2xl:text-lg font-normal",subtitle4:"text-xs md:text-xs lg:text-xs xl:text-sm 2xl:text-base font-normal",caption1:"text-xs md:text-xs lg:text-sm xl:text-sm 2xl:text-base font-light",caption2:"text-xs md:text-xs lg:text-xs xl:text-xs 2xl:text-sm font-light"})[e];var c=e=>{let{size:t="body3",children:l,className:a,color:n="text-white",inline:x=!1}=e,c="".concat(x?"inline":"block"," ").concat(n," ").concat(a," ").concat(r(t)," ").concat(-1===t.indexOf("body")&&-1===t.indexOf("subtitle")?"uppercase":"");if(["display1","display2","subtitle1","subtitle2","subtitle3","subtitle4","caption1","caption2","button1","button2","button3"].includes(t)||x)return(0,s.jsx)("div",{className:c,children:l});if(["body1","body2","body3","body4","body5","body6"].includes(t))return(0,s.jsx)("p",{className:c,children:l});let i={h1:e=>(0,s.jsx)("h1",{...e}),h2:e=>(0,s.jsx)("h2",{...e}),h3:e=>(0,s.jsx)("h3",{...e}),h4:e=>(0,s.jsx)("h4",{...e}),h5:e=>(0,s.jsx)("h5",{...e}),h6:e=>(0,s.jsx)("h6",{...e})};if(["h1","h2","h3","h4","h5","h6"].includes(t)){let e=i[t]||i.h1;if(e)return(0,s.jsx)(e,{className:c,children:l})}return(0,s.jsx)("p",{className:"".concat(n," font-kanit font-light ").concat(t," ").concat(a),children:l})},i=e=>{let{title:t,children:l,disabled:n}=e,[r,i]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{n||i(!0)},[n]),(0,s.jsxs)("div",{className:"my-4 flex flex-col",children:[(0,s.jsxs)("div",{onClick:()=>{n||i(!r)},className:"flex w-full cursor-pointer flex-row justify-between rounded-lg border-b-2 border-zinc-800 bg-zinc-900 px-4 pb-2 pt-4",children:[(0,s.jsx)(c,{size:"h4",children:t}),(0,s.jsx)(x,{className:"m-2 mt-3 w-5 ".concat(r&&"rotate-180")})]}),(0,s.jsx)("div",{className:"w-full overflow-x-hidden p-4 px-2 transition-all duration-500 ease-in-out ".concat(r?"max-h-[2000px] px-0 opacity-100":"max-h-0 scale-y-0 opacity-0"," origin-top"),children:l})]})},o=e=>{let{text:t,onClick:l,disabled:a}=e;return(0,s.jsx)("button",{disabled:a,onClick:l,className:"self-end rounded-lg bg-[#4c84ff] px-5 py-2 ".concat(a&&"bg-zinc-500"),children:(0,s.jsx)(c,{size:"body4",className:"uppercase",children:t})})},d=e=>{let{title:t,placeholder:l,onChange:a,textAreaOnChange:n,type:x="text",className:r}=e,i="w-3/5 cursor-pointer rounded-lg border border-zinc-800 bg-zinc-900 px-6 py-2 text-white outline-none placeholder:text-zinc-600 active:border-zinc-500 ".concat(r);return(0,s.jsxs)("div",{className:"flex flex-col gap-2.5",children:[(0,s.jsx)(c,{size:"caption1",className:"uppercase text-white",children:t}),"textarea"===x?(0,s.jsx)("textarea",{onChange:n,placeholder:l,className:"h-40 ".concat(i)}):(0,s.jsx)("input",{type:x,onChange:a,placeholder:l,className:i})]})};let u=(e,t)=>{switch(t.type){case"updatePolicyName":return{...e,policyName:t.policyName};case"updateSmartContractAddress":return{...e,smartContractAddress:t.smartContractAddress};case"updateAbi":return{...e,abi:t.abi};case"updateFunctionsSelected":return{...e,functionsSelected:t.functionsSelected};case"updateNftIds":return{...e,nftIds:t.nftIds};case"updateMaxTransactionsPerUser":return{...e,maxTransactionsPerUser:t.maxTransactionsPerUser};case"updateMaxTransactionsPerPolicy":return{...e,maxTransactionsPerPolicy:t.maxTransactionsPerPolicy};case"updateMaxGasPerUser":return{...e,maxGasPerUser:t.maxGasPerUser};case"updateMaxGasPerPolicy":return{...e,maxGasPerPolicy:t.maxGasPerPolicy};case"updatePolicyStart":return{...e,policyStartTimestamp:t.policyStart};case"updatePolicyEnd":return{...e,policyEndTimestamp:t.policyEnd};case"updateAddresses":return{...e,addresses:t.addresses};default:throw"Bad action type"}},p={policyName:"",smartContractAddress:"",abi:"",functionsSelected:[],nftIds:[""],addresses:[""],maxTransactionsPerUser:0,maxTransactionsPerPolicy:0,maxGasPerUser:0,maxGasPerPolicy:0,policyStartTimestamp:"",policyEndTimestamp:""},m=(0,a.createContext)([p,()=>null]),h=()=>(0,a.useContext)(m);var f=e=>{let{children:t}=e,l=(0,a.useReducer)(u,p);return(0,s.jsx)(m.Provider,{value:l,children:t})},y=e=>{let{onCompleted:t}=e,[{policyName:l},a]=h();return(0,s.jsx)(i,{title:"Policy Details",children:(0,s.jsxs)("div",{className:"flex flex-col gap-14",children:[(0,s.jsx)(d,{title:"Policy Name",placeholder:"Ex. Gas fee Sponsor",onChange:e=>{a({type:"updatePolicyName",policyName:e.target.value})}}),(0,s.jsx)(o,{text:"Next",onClick:t,disabled:0==l.length})]})})},b=e=>{let{canBeOpened:t,onCompleted:l}=e,[{maxTransactionsPerPolicy:a,maxTransactionsPerUser:n,maxGasPerPolicy:x,maxGasPerUser:r},c]=h();return(0,s.jsx)(i,{disabled:!t,title:"Spending Rules",children:(0,s.jsxs)("div",{className:"flex flex-col gap-10",children:[(0,s.jsx)(d,{onChange:e=>{c({type:"updateMaxTransactionsPerUser",maxTransactionsPerUser:Number(e.target.value)})},title:"Max Transactions per User",placeholder:"0",type:"number"}),(0,s.jsx)(d,{onChange:e=>{c({type:"updateMaxTransactionsPerPolicy",maxTransactionsPerPolicy:Number(e.target.value)})},title:"Max Transactions per Policy",placeholder:"0",type:"number"}),(0,s.jsx)(d,{onChange:e=>{c({type:"updateMaxGasPerUser",maxGasPerUser:Number(e.target.value)})},title:"Max Gas per User",placeholder:"0",type:"number"}),(0,s.jsx)(d,{onChange:e=>{c({type:"updateMaxGasPerPolicy",maxGasPerPolicy:Number(e.target.value)})},title:"Max Gas per Policy",placeholder:"0",type:"number"}),(0,s.jsx)(o,{text:"Next",onClick:l,disabled:!x&&!r&&!a&&!n})]})})},g=e=>{let{ids:t}=e,[l,n]=h(),x=(0,a.useRef)([]),r=(e,l)=>{"Enter"===l.key&&(l.preventDefault(),n({type:"updateNftIds",nftIds:[...t,""]}),setTimeout(()=>{x.current[e+1]&&x.current[e+1].focus()},0))},i=(e,l)=>{let s=[...t];s[e]=l.target.value,n({type:"updateNftIds",nftIds:s})};return(0,a.useEffect)(()=>{x.current[0]&&x.current[0].focus()},[]),(0,s.jsx)("div",{className:"w-3/5 cursor-pointer rounded-lg border border-zinc-800 bg-zinc-900 px-6 py-2 text-white",children:t.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(c,{size:"caption1",className:"uppercase text-zinc-400",children:t+1}),(0,s.jsx)("input",{type:"text",value:e,onChange:e=>i(t,e),onKeyDown:e=>r(t,e),ref:e=>{e&&(x.current[t]=e)},placeholder:"NFT #ID to own to spend gas",className:"w-11/12 bg-transparent px-6 py-2 outline-none placeholder:text-zinc-600 active:border-zinc-500"})]},t))})},j=e=>{let{canBeOpened:t,onCompleted:l}=e,[n,x]=(0,a.useState)([]),[{smartContractAddress:r,functionsSelected:u,abi:p,nftIds:m},f]=h();(0,a.useEffect)(()=>{p.length>0&&x(function(e){try{return JSON.parse(e).filter(e=>"function"===e.type&&e.inputs.length>0).map(e=>e.name)}catch(e){return console.error("Error parsing ABI:",e),[]}}(p))},[p]);let y=e=>{f({type:"updateFunctionsSelected",functionsSelected:u.includes(e)?u.filter(t=>t!==e):[...u,e]})};return(0,s.jsx)(i,{disabled:!t,title:"Smart Contract Rules",children:(0,s.jsxs)("div",{className:"flex flex-col gap-10",children:[(0,s.jsx)(d,{onChange:e=>{f({type:"updateSmartContractAddress",smartContractAddress:e.target.value})},title:"Smart Contract Allowed to Spend Gas",placeholder:"0xabc...efg"}),(0,s.jsxs)("div",{className:"flex flex-col gap-2.5",children:[(0,s.jsx)(c,{size:"caption1",className:"uppercase text-white",children:"NFT Ids"}),(0,s.jsx)(g,{ids:m})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between gap-8",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,s.jsx)(c,{size:"subtitle2",className:"uppercase text-white",children:"Add ABI and select allowed contract methods"}),(0,s.jsx)(d,{className:"!w-full",textAreaOnChange:e=>{f({type:"updateAbi",abi:e.target.value})},title:"Smart contract abi",placeholder:'[{\n                            inputs: [\n                                { internalType: "uint256", name: "_tokenId", type: "uint256" },\n                                { internalType: "uint256", name: "_option", type: "uint256" },\n                                { internalType: "uint256", name: "_stakeAmount", type: "uint256" },\n                            ],\n                            name: "claimAavegotchi",\n                            outputs: [],\n                            stateMutability: "nonpayable",\n                            type: "function",\n                            }]',type:"textarea"})]}),n.length>0&&(0,s.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,s.jsx)(c,{size:"subtitle2",className:"uppercase text-white",children:"Select allowed contract methods"}),(0,s.jsx)("div",{className:"max-h-[200px] overflow-y-auto",children:n.map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("input",{type:"checkbox",checked:u.includes(e),onChange:()=>y(e)}),(0,s.jsx)(c,{size:"subtitle2",className:"text-white",children:e})]},e))})]})]}),(0,s.jsx)(o,{text:"Next",disabled:0==r.length||0==m[0].length,onClick:l})]})})},N=l(1796),v=e=>{let{addresses:t}=e,[l,n]=h(),x=(0,a.useRef)([]),r=(e,l)=>{if("Enter"===l.key){l.preventDefault();let s=t[e];N.UJ(s)?(n({type:"updateAddresses",addresses:[...t,""]}),setTimeout(()=>{x.current[e+1]&&x.current[e+1].focus()},0)):alert("Please enter a valid Ethereum address.")}},i=(e,l)=>{let s=[...t];s[e]=l.target.value,n({type:"updateAddresses",addresses:s})};return(0,a.useEffect)(()=>{x.current[0]&&x.current[0].focus()},[]),(0,s.jsx)("div",{className:"w-3/5 cursor-pointer rounded-lg border border-zinc-800 bg-zinc-900 px-6 py-2 text-white",children:t.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(c,{size:"caption1",className:"uppercase text-zinc-400",children:t+1}),(0,s.jsx)("input",{type:"text",value:e,onChange:e=>i(t,e),onKeyDown:e=>r(t,e),ref:e=>{e&&(x.current[t]=e)},placeholder:"Enter address and press Enter",className:"w-11/12 bg-transparent px-6 py-2 outline-none placeholder:text-zinc-600 active:border-zinc-500"})]},t))})},P=e=>{let{canBeOpened:t,onCompleted:l}=e,[{addresses:a}]=h();return(0,s.jsx)(i,{disabled:!t,title:"Access Controls",children:(0,s.jsxs)("div",{className:"flex flex-col gap-14",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,s.jsx)(c,{size:"caption1",className:"uppercase text-white",children:"Allow list"}),(0,s.jsx)(v,{addresses:a})]}),(0,s.jsx)(o,{text:"Next",onClick:l,disabled:0==a[0].length})]})})},w=l(7908),C=e=>{let{canBeOpened:t}=e,[l,n]=(0,a.useState)(""),[x,r]=(0,a.useState)(""),[{smartContractAddress:c,functionsSelected:u,abi:p,policyName:m,nftIds:f,policyEndTimestamp:y,policyStartTimestamp:b,addresses:g,maxGasPerPolicy:j,maxGasPerUser:N},v]=h(),P=async()=>{let e=await w.Z.post("/api/smartContractPolicy",{contractAddress:c,sponsoredMethods:u,abi:p,policyName:m,maxGasPerUser:N,maxGasPerPolicy:j,allowlist:g,nftIds:f,policyStart:b,policyEnd:y});console.log(e),200===e.status&&alert("Policy created successfully")};return(0,s.jsx)(i,{disabled:!t,title:"Expiry and Durations",children:(0,s.jsxs)("div",{className:"flex w-full flex-col gap-14",children:[(0,s.jsxs)("div",{className:"flex w-full items-center gap-10",children:[(0,s.jsx)(d,{title:"Policy Start",className:"!w-full",onChange:e=>{n(e.target.value)},placeholder:"",type:"datetime-local"}),(0,s.jsx)(d,{title:"Policy End",className:"!w-full",placeholder:"",type:"datetime-local",onChange:e=>{r(e.target.value)}})]}),(0,s.jsx)(o,{text:"Submit",onClick:()=>{let e=new Date(l).getTime()/1e3,t=new Date(x).getTime()/1e3;v({type:"updatePolicyStart",policyStart:e.toString()}),v({type:"updatePolicyEnd",policyEnd:t.toString()}),P()}})]})})};function S(){let[e,t]=(0,a.useState)(0),l=e=>{t(e)};return(0,s.jsx)(f,{children:(0,s.jsxs)("div",{className:"bg-primary-black flex min-h-screen w-screen flex-col px-20 py-16 xl:px-36 xl:py-20",children:[(0,s.jsx)(y,{onCompleted:()=>l(1)}),(0,s.jsx)(b,{canBeOpened:e>0,onCompleted:()=>l(2)}),(0,s.jsx)(j,{canBeOpened:e>1,onCompleted:()=>l(3)}),(0,s.jsx)(P,{canBeOpened:e>2,onCompleted:()=>l(4)}),(0,s.jsx)(C,{canBeOpened:e>3})]})})}}},function(e){e.O(0,[167,971,69,744],function(){return e(e.s=5787)}),_N_E=e.O()}]);